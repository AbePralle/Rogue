$include "Standard/Boss.rogue"
$using Boss

class Robot
  PROPERTIES
endClass

local vm = VM()
vm.register( "Robot", 0, function(task)=task.push( Robot() ) )

vm.register( "println", 0,
  function(task:Task)
    forEach (i in 0..(task.arg_count-1))
      print task.arg(i)
    endForEach
    println
    task.push( null )
  endFunction
)

#local task = vm.execute( "Robot()" )

vm.execute @|println 5 6 7+8
            |println null

local nums = Int32[](4)
nums.add(1)
nums.add(2)
nums.add(3)
nums.add(4)
println nums
local rebuilder = nums.rebuilder
forEach (n in rebuilder)
  if (n == 2) rebuilder.write(0).write(0).write(6)
  else        rebuilder.write(n)
endForEach
println nums
forEach (n in rebuilder.reset)
  rebuilder.write( -n )
endForEach
println nums
